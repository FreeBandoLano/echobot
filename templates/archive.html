{% extends "base.html" %}

{% block title %}Archive • Radio Synopsis{% endblock %}

{% block nav_archive %}app-nav__link--active{% endblock %}

{% block head_extra %}
<style>
    /* Mobile-specific styles for archive page */
    @media (max-width: 768px) {
        .archive-row {
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-radius: 12px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .archive-row:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .archive-row__date {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .archive-row__day {
            font-weight: 600;
            color: var(--primary-color);
            min-width: 2.5rem;
        }

        .archive-row__md {
            font-size: 1rem;
            color: var(--text-color);
        }

        .archive-row__yr {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .archive-row__meta {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .archive-row__title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
            line-height: 1.3;
        }

        .archive-row__stats {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .archive-progress {
            width: 100%;
            height: 6px;
            background: var(--surface-hover);
            border-radius: 3px;
            overflow: hidden;
        }

        .archive-progress__bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            width: var(--p);
            transition: width 0.3s ease;
        }

        .archive-row__actions {
            align-self: flex-end;
        }

        .block-action {
            padding: 0.5rem 1rem;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            min-width: 60px;
        }

        .block-action:hover {
            background: var(--primary-hover);
            transform: scale(1.05);
        }

        .archive-empty {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary);
        }

        .archive-empty i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Mobile action bar styles */
        .mobile-action-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface-color);
            border-top: 1px solid var(--border-color);
            padding: 0.75rem;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }

        .mobile-action-bar button {
            background: none;
            border: none;
            padding: 0.5rem;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            min-width: 60px;
            cursor: pointer;
        }

        .mobile-action-bar button:hover {
            background: var(--surface-hover);
            color: var(--primary-color);
        }

        .mobile-action-bar button.active {
            color: var(--primary-color);
            background: var(--primary-light);
        }

        .mobile-action-bar button i {
            font-size: 1.2rem;
        }

        .mobile-action-bar button span {
            font-size: 0.7rem;
            font-weight: 500;
        }

        /* Adjust main content for mobile action bar */
        main {
            padding-bottom: 5rem;
        }
    }

    /* Hide mobile action bar on desktop */
    @media (min-width: 769px) {
        .mobile-action-bar {
            display: none;
        }

        main {
            padding-bottom: 2rem;
        }
    }
</style>
{% endblock %}

{% block content %}
    <section class="panel" data-active="true">
        <h2><i class="bi bi-archive"></i> Archive</h2>
        <p class="section-sub">Historical briefings and processed blocks</p>

        <div class="archive-list" role="list">
            {% for show in archive_data %}
                <div class="archive-row" role="listitem" onclick="location.href='/?date_param={{ show.show_date }}'" tabindex="0">
                    <div class="archive-row__date">
                        <div class="archive-row__day">{{ show.show_date.strftime('%a') }}</div>
                        <div class="archive-row__md">{{ show.show_date.strftime('%b %d') }}</div>
                        <div class="archive-row__yr">{{ show.show_date.strftime('%Y') }}</div>
                    </div>
                    <div class="archive-row__meta">
                        <div class="archive-row__title">{{ show.title or 'Program' }}</div>
                        <div class="archive-row__stats">{{ show.completed_blocks }}/{{ show.total_blocks }} blocks · {{ (show.completed_blocks / show.total_blocks * 100) if show.total_blocks > 0 else 0 | round }}% complete</div>
                        <div class="archive-progress">
                            <div class="archive-progress__bar" style="--p: {{ (show.completed_blocks / show.total_blocks * 100) if show.total_blocks > 0 else 0 }}%"></div>
                        </div>
                    </div>
                    <div class="archive-row__actions">
                        <button class="block-action" onclick="event.stopPropagation(); location.href='/?date_param={{ show.show_date }}'">VIEW</button>
                    </div>
                </div>
            {% endfor %}
            {% if not archive_data %}
                <div class="archive-empty">
                    <i class="bi bi-archive"></i>
                    <p>No archived briefings yet.</p>
                </div>
            {% endif %}
        </div>
    </section>
{% endblock %}

{% block mobile_action_bar %}
    <!-- Mobile Action Bar -->
    <nav class="mobile-action-bar" aria-label="Quick actions">
        <button onclick="location.href='/'"><i class="bi bi-house"></i><span>Home</span></button>
        <button onclick="location.href='/archive'" class="active"><i class="bi bi-archive"></i><span>Archive</span></button>
        <button onclick="window.history.back()"><i class="bi bi-arrow-left"></i><span>Back</span></button>
    </nav>
{% endblock %}
